# PostgreSQL vs pandas

Примеры запросов на чистом SQL из учебного пособия по СУБД PostgreSQL, переработанные с использованием Python и библиотеки pandas.

В качестве учебной базы данных рассматривается БД «Авиаперевозки», подготовленная компанией Postgres Professional.

## Развертывание БД в кластере PostgreSQL

В качестве первого шага к развертыванию базы данных нужно скачать ее заархивированную резервную копию по ссылке https://edu.postgrespro.ru/demo_small.zip. Затем необходимо извлечь файл из архива:

```bash
wget https://edu.postgrespro.ru/demo-small.zip
unzip demo_small.zip
```
Извлеченный файл называется demo_small.sql. Теперь создадим базу данных с именем demo в вашем кластере PostgreSQL:

```bash
zcat demo-small.zip | psql
```
или

```bash
psql -f demo_small.sql -U postgres
```
Если вы хотите перенаправить вывод сообщений, которые генерирует СУБД в процессе работы, с экрана в файлы, то можно поступить так:

```bash
psql -f demo_small.sql -U postgres > demo.log 2>demo.err
```

Можно разделить стандартное устройство вывода и стандартное устройство вывода ошибок. Обычные сообщения будут перенаправлены в файл demo.log, а сообщения об ошибках — в файл demo.err. Обратите внимание, что между цифрой 2, обозначающей дескриптор стандартного устройства вывода сообщений об ошибках, и знаком «>», обозначающим переадресацию вывода, не должно быть пробела.

Если вам удобнее собрать все сообщения в один общий файл, тогда нужно сделать так:

```bash
psql -f demo_small.sql -U postgres > demo.log 2>&1
```

Обратите внимание, что все выражение 2>&1 в конце команды пишется без пробелов. Оно указывает операционной системе, что сообщения об ошибках нужно направить туда же, куда выводятся и обычные сообщения.

Если бы наш SQL-файл был очень большим, тогда можно было бы выполнить команду в фоновом режиме, поставив в конце командной строки символ «&», а за ходом процесса в реальном времени наблюдать с помощью команды tail.

```bash
psql -f demo_small.sql -U postgres > demo.log 2>&1 & tail -f demo.log
```

Выберите один из предложенных вариантов команды для развертывания базы данных и выполните эту команду. Все готово! Можно подключаться к новой базе данных:

```bash
psql -d demo -U postgres
```

Для связи Python с СУБД PostgreSQL используется библиотека psycopg2.

